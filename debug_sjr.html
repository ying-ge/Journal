<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SJR æ•°æ®è°ƒè¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        .debug-info {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>ğŸ” SJR æ•°æ®è°ƒè¯•é¡µé¢</h1>
    <div id="results"></div>

    <script src="sjr_metrics.js"></script>
    <script>
        const resultsDiv = document.getElementById('results');

        function addResult(message, type) {
            const div = document.createElement('div');
            div.className = 'debug-info';
            div.innerHTML = message;
            resultsDiv.appendChild(div);
        }

        // æ£€æŸ¥æ•°æ®åŠ è½½
        if (typeof sjrMetrics === 'undefined') {
            addResult('âŒ sjrMetrics æœªå®šä¹‰ï¼', 'error');
            addResult('å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š<br>1. æ£€æŸ¥æ–‡ä»¶è·¯å¾„<br>2. æ£€æŸ¥ GitHub Pages æ–‡ä»¶å¤§å°é™åˆ¶<br>3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯', 'warning');
        } else {
            addResult(`âœ… sjrMetrics å·²åŠ è½½ï¼ŒåŒ…å« ${Object.keys(sjrMetrics).length.toLocaleString()} ç§æœŸåˆŠ`, 'success');

            // æµ‹è¯•å‡ ä¸ªæœŸåˆŠ
            const testJournals = ['NATURE', 'SCIENCE', 'CELL'];

            testJournals.forEach(journal => {
                const data = sjrMetrics[journal];
                if (data) {
                    const apcValue = parseInt(data.apc_usd);
                    const apcDisplay = apcValue === 0 ? 'FREE' : `$${apcValue.toLocaleString()}`;

                    addResult(`
                        <strong>${journal}</strong><br>
                        SJR: ${data.sjr}<br>
                        Quartile: ${data.sjr_quartile}<br>
                        Total Docs: ${data.total_docs}<br>
                        <strong style="color: green;">APC: ${apcDisplay}</strong>
                    `, 'success');
                } else {
                    addResult(`âŒ æœªæ‰¾åˆ°æœŸåˆŠ: ${journal}`, 'error');
                }
            });

            // æ£€æŸ¥ apc_usd å­—æ®µè¦†ç›–ç‡
            let withAPC = 0;
            Object.values(sjrMetrics).forEach(data => {
                if (data.apc_usd) withAPC++;
            });

            addResult(`ğŸ“Š APC å­—æ®µè¦†ç›–ç‡: ${withAPC}/${Object.keys(sjrMetrics).length} (${(withAPC/Object.keys(sjrMetrics).length*100).toFixed(1)}%)`, withAPC > 0 ? 'success' : 'error');

            // æ˜¾ç¤ºå‰5ä¸ªæœŸåˆŠçš„å®Œæ•´æ•°æ®
            addResult('<strong>å‰5ä¸ªæœŸåˆŠçš„å®Œæ•´æ•°æ®:</strong>', 'info');
            let count = 0;
            for (const [key, value] of Object.entries(sjrMetrics)) {
                if (count >= 5) break;
                addResult(`
                    ${key}:<br>
                    SJR: ${value.sjr}<br>
                    Quartile: ${value.sjr_quartile}<br>
                    Total Docs: ${value.total_docs}<br>
                    APC: ${value.apc_usd}
                `, 'info');
                count++;
            }
        }
    </script>
</body>
</html>
